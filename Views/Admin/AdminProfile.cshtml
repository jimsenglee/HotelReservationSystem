@model HotelRoomReservationSystem.Models.ViewModels.UpdateUserVM
@{
	//Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<style>
	.form-container {
		display: flex;
		gap: 20px;
	}

	.form-section {
		flex: 1;
		padding: 20px;
		gap: 1rem;
		display: flex;
		flex-direction: column;
		flex-wrap: nowrap;
		/* //justify-content: center; */
	}

	.form-group {
		margin-bottom: 15px;
		position: relative;
	}

		.form-group label {
			display: block;
			margin-bottom: 5px;
			font-weight: bold;
		}

		.form-group input,
		.form-group select,
		.form-group textarea {
			width: 100%;
			padding: 1rem;
			box-sizing: border-box;
			border: 1px solid #ccc;
			border-radius: 5px;
		}

		.form-group .upload {
			display: flex;
			flex-direction: column;
			align-items: center;
			text-align: center;
			margin-top: 1rem;
		}

			.form-group .upload img {
				width: 200px;
				height: 200px;
				border-radius: 50%;
				object-fit: cover;
				border: 2px solid #ccc;
				margin-bottom: 0.5rem;
			}

			svg#togglePassword,
	svg#toggleConPassword,
	svg#toggleDonPassword{
		position: absolute;
		top: 50px;
		right:10px;
		transform: translateY(-50%);
		cursor: pointer;
		color: #666;
		font-size: 16px;
	}

		.form-group textarea {
			resize: vertical;
		}

	.upload-container {
		display: flex;
		flex-direction: column;
		align-items: center;
		width: 100%;
		max-width: 500px;
		margin: auto;
		margin-bottom: 2rem;
	}

	.dropbox {
		border: 2px dashed #ccc;
		border-radius: 8px;
		padding: 20px;
		text-align: center;
		width: 100%;
		max-width: 500px;
		position: relative;
		background-color: #f9f9f9;
		transition: background-color 0.3s;
	}

		.dropbox:hover {
			background-color: #f1f1f1;
		}

	.plus-icon {
		font-size: 36px;
		font-weight: bold;
		color: #666;
		margin-bottom: 10px;
	}

	button#selectImages {
		margin-top: 10px;
		background-color: #007bff;
		color: white;
		border: none;
		padding: 10px 15px;
		border-radius: 5px;
		cursor: pointer;
	}

		button#selectImages:hover {
			background-color: #0056b3;
		}

	.preview-container {
		display: flex;
		flex-wrap: wrap;
		margin-top: 20px;
		gap: 10px;
		align-items: center;
		justify-content: center;
	}

		.preview-container img {
			width: 100px;
			height: 100px;
			object-fit: cover;
			border: 1px solid #ddd;
			border-radius: 5px;
		}

	/* Container styling for images */
	.image-container {
		position: relative;
		display: inline-block;
		margin: 10px;
	}

		/* Styling the image */
		.image-container img {
			width: 100px;
			height: 100px;
			border: 1px solid #ccc;
			border-radius: 5px;
		}

	/* Cancel button styling */
	.cancel-button {
		position: absolute;
		top: -5px;
		right: -5px;
		background-color: #ff4d4d;
		color: white;
		border: none;
		border-radius: 50%;
		font-size: 12px;
		width: 10px;
		height: 10px;
		padding: 1rem;
		cursor: pointer;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
	}

		.cancel-button:hover {
			background-color: #ff1a1a;
		}

	.field-validation-error,
	.validation-summary-errors {
		color: red;
	}

	.input-validation-error {
		border: 2px solid red !important;
		outline: none;
	}

	svg#togglePassword,
	svg#toggleConPassword,
	svg#toggleDonPassword, {
		position: absolute;
		top: 65%;
		right: 10px;
		transform: translateY(-50%);
		cursor: pointer;
		color: #666;
		font-size: 16px;
	}

	svg:hover {
		fill: #000;
	}

	.hidden-field {
		position: absolute;
		left: -9999px;
	}

	.modal {
		display: none; /* Ensures the modal is hidden by default */
		position: fixed; /* Makes the modal fixed on the screen */
		top: 50%; /* Centers vertically */
		left: 50%; /* Centers horizontally */
		transform: translate(-50%, -50%); /* Ensures perfect centering */
		z-index: 1050; /* Ensures it overlaps other elements */
		max-width: 90%; /* Optional: Ensures responsiveness */
		background: white;
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
		border-radius: 8px;
		padding: 20px;
	}

	.modal-backdrop {
		position: fixed; /* Ensures it covers the full screen */
		top: 0;
		left: 0;
		width: 100vw;
		height: 100vh;
		background-color: rgba(0, 0, 0, 0.5); /* Dimmed background */
		z-index: 1040; /* Slightly lower z-index than the modal */
	}

	.modal-dialog {
		position: relative;
		margin: auto;
		max-width: 600px; /* Responsive width */
		width: 100%;
	}

	.modal-content {
		border-radius: 8px;
		overflow: hidden;
		/* box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); */
	}

	.modal-header {
		/* background-color: #f8f9fa; Light gray for header */
		/* border-bottom: 1px solid #ddd; */
		display: flex;
		justify-content: flex-end;
		padding-bottom: 1rem;
	}


	.modal-dialog-centered {
		display: flex;
		justify-content: center;
		align-items: center;
	}

	.modal-footer {
		padding: 10px;
		/* background-color: #f8f9fa; */
		/* border-top: 1px solid #ddd; */
	}

		.modal-footer .btn {
			margin: 0 5px;
		}

	#idwebcam {
		width: 100%;
		height: auto;
		max-width: 360px;
		margin: auto;
		border-radius: 8px;
		background-color: #f9f9f9;
	}

	#idcaptured {
		width: 100%;
		height: auto;
		max-width: 360px;
		margin: auto;
		border-radius: 8px;
		background-color: #f9f9f9;
	}

	#idcaptured {
		max-width: 100%;
		border-radius: 5px;
		border: 1px solid #ddd;
	}

	.btn-close {
		color: #333;
		font-size: 1.2rem;
		border: none;
		background: none;
		width: 40px;
		height: 40px;
		display: flex;
		justify-content: center;
		align-items: center;
		border-radius: 50%;
		cursor: pointer;
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
		transition: background-color 0.3s;
	}

		.btn-close:hover {
			background-color: rgba(0, 0, 0, 0.1);
		}

		.btn-close::before {
			content: "\2715"; /* Unicode character for a cross symbol */
			font-size: 1.2rem;
			color: #333;
		}

	.btn-success {
		background-color: #28a745;
		border-color: #28a745;
	}

		.btn-success:hover {
			background-color: #218838;
			border-color: #1e7e34;
		}

	.btn-primary {
		background-color: #007bff;
		border-color: #007bff;
	}

		.btn-primary:hover {
			background-color: #0056b3;
			border-color: #004085;
		}

	.nav-borders {
		display: flex;
		justify-content: start;
		gap: 1.5rem;
		border-bottom: 2px solid #ddd;
		padding: 0.5rem 0;
	}

		.nav-borders .nav-link {
			text-decoration: none;
			font-size: 1rem;
			color: #333;
			padding: 0.5rem 0.75rem;
			transition: all 0.3s ease;
			border-bottom: 2px solid transparent;
		}

			.nav-borders .nav-link:hover {
				color: #007bff;
				border-bottom: 2px solid #007bff;
			}

			.nav-borders .nav-link.active {
				color: #007bff;
				font-weight: bold;
				border-bottom: 2px solid #007bff;
			}

			.nav-borders .nav-link.ms-0 {
				margin-left: 0 !important;
			}
</style>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.unobtrusive-ajax.min.js"></script>
<script src="/js/jquery.validate.min.js"></script>
<script src="/js/jquery.validate.unobtrusive.min.js"></script>
<script src="/js/app.js" asp-append-version="true"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

<script src="/js/Webcam.js" type="text/javascript"></script>
<script type="text/javascript">
	$(function(){
		let cameraActive = false;

		Webcam.set({
			width:360,
			height:260,
			image_format:'jpeg',
			jpeg_quality:75
		});
	   $('#captureModal').on('show.bs.modal', function () {
		if (!cameraActive) {
			Webcam.attach('#idwebcam');
			cameraActive = true;
		}
	});

	// Close Camera on Modal Hide
	$('#captureModal').on('hide.bs.modal', function () {
		if (cameraActive) {
			Webcam.reset();
			cameraActive = false;
		}
	});

		   $("#btncapture").click(function () {
		Webcam.snap(function (data_uri) {
			$("#idcaptured")[0].src = data_uri; // Set image preview
		   $("input[asp-for='Base64Photo']").val(data_uri); // Assign Base64 string to hidden input
		   $("#base64PhotoInput").val(data_uri);
		});
	});

		$("#savePhotoButton").click(function () {
			const capturedDataUri = $("#idcaptured").attr("src");
			if (capturedDataUri) {
				$("#profileImage").attr("src", capturedDataUri);

			}
		});

		// Upload Photo Input
		$("#uploadInput").change(function () {
			const file = this.files[0];
			if (file) {
				const reader = new FileReader();
				reader.onload = function (e) {
					$("#profileImage").attr("src", e.target.result); // Update Profile Preview
				};
				reader.readAsDataURL(file);
			}
		});


	});

</script>


<div class="body-content flex flex-column">
	
	<main class="flex flex-column grow">
		<nav class="nav nav-borders">
			<a class="nav-link active ms-0" data-ajax="true" href="#" data-url="/Admin/AdminProfile">Profile</a>
			@* <a class="nav-link" href="#" data-ajax="true" data-url="">Billing</a> *@
			<a class="nav-link" href="#" data-ajax="true" data-url="/Admin/editAdminPassword">Security</a>
			@* <a class="nav-link" href="#" data-ajax="true" data-url="">Notifications</a> *@
		</nav>
		
		<section class="flex flex-column gap-2" >
			<form id="roomForm" class="form" enctype="multipart/form-data" method="post">
				<div class="form-container">
					<!-- Left Section -->
					<div class="form-section">
						<!-- Hidden input to pass Id -->

						<input asp-for="id" hidden />

						<div class="form-group">
							<label asp-for="FirstName"></label>
							<input asp-for="FirstName" data-trim placeholder="Enter First Name" />
							<span asp-validation-for="FirstName"></span>
						</div>

						<div class="form-group">
							<label asp-for="LastName"></label>
							<input asp-for="LastName" data-trim placeholder="Enter Last Name" />
							<span asp-validation-for="LastName"></span>
						</div>

						<div class="form-group">
							<label asp-for="BirthDay"></label>
							<input asp-for="BirthDay" type="date" placeholder="BirthDay">
							<span asp-validation-for="BirthDay" class="validation-error"></span>
						</div>

						<div class="form-group">
							<label asp-for="Email"></label>
							<input asp-for="Email" type="text" placeholder="Email" readonly>
							<span asp-validation-for="Email" class="validation-error"></span>
						</div>


					</div>

					<!-- Right Section -->
					<div class="form-section">
						<div class="form-group">
							<label asp-for="PhoneNum"></label>
							<input asp-for="PhoneNum" type="text" placeholder="Phone Number">
							<span asp-validation-for="PhoneNum" class="validation-error"></span>
						</div>

						<div class="form-group">
							<label class="upload">
								<label asp-for="portrait"></label>
								<img id="profileImage" class="img-account-profile rounded-circle mb-2" style="width: 200px; height: 200px; object-fit: cover;" src="/images/user_photo/@Model.portrait" alt="">
								<div class="small font-italic text-muted mb-4">JPG or PNG no larger than 5 MB</div>
								<input asp-for="Photo" name="Photo" accept="image/jpeg,image/png" hidden>
								<span asp-validation-for="Photo" class="validation-error"></span>
							</label>
							<button type="button" class="btn btn-secondary mt-2" data-bs-toggle="modal" data-bs-target="#captureModal">
								Take Photo
							</button>
							<input type="hidden" id="base64PhotoInput" asp-for="Base64Photo" />
							<span asp-validation-for="Base64Photo" class="validation-error"></span>
						</div>



						<!-- Modal -->
						<div class="modal fade" id="captureModal" tabindex="-1" aria-labelledby="captureModalLabel" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered">
								<div class="modal-content">
									<!-- Modal Header -->
									<div class="modal-header">
										@* <h5 class="modal-title" id="captureModalLabel">Take Photo</h5> *@
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="padding:0;"></button>
									</div>

									<!-- Modal Body -->
									<div class="modal-body text-center">
										<!-- Webcam Video Stream -->
										<div id="idwebcam" class="mb-3"></div>
										@* <br /> *@
										@* <div style="display:flex;justify-content: center;"> *@
										@* 	<button type="button" id="btncapture" class="btn btn-success" style="margin-top: 10px;">Capture</button> *@
										@* </div> *@
										<p>Captured Image</p>
										<img id="idcaptured" class="mb-3" />
									</div>

									<!-- Modal Footer -->
									<div class="modal-footer d-flex justify-content-between">
										<div style="display:flex;justify-content: center;">
											<button type="button" class="btn btn-primary" id="savePhotoButton">Save Photo</button>
											<button type="button" id="btncapture" class="btn btn-success">Capture</button>
											<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
										</div>


									</div>
								</div>
							</div>
						</div>




					</div>
				</div>

				<!-- Submit Button -->
				<div class="submit-btn" style="display:flex;flex-direction:row-reverse;">
					<button id="submitBtn">Submit</button>
				</div>
			</form>

		</section>
	</main>
</div>

<script>
		document.addEventListener('DOMContentLoaded', function () {
	//     Get references to elements
	//     const uploadButton = document.getElementById('uploadButton');
	//     const portraitInput = document.getElementById('Portrait');

	//     Add event listener to the button
	//     uploadButton.addEventListener('click', function () {
	//         portraitInput.click(); Trigger the hidden file input
	//     });

	//     portraitInput.addEventListener('change', function () {
	//     const file = portraitInput.files[0];
	//     if (file && (file.type === "image/jpeg" || file.type === "image/png")) {
	//         const reader = new FileReader();
	//         reader.onload = function (e) {
	//             profileImage.src = e.target.result; Update the image source
	//         };
	//         reader.readAsDataURL(file);
	//     } else {
	//         alert("Please select a valid JPG or PNG image.");
	//     }
	// });
		$('.upload input').on('change', e => {
		const f = e.target.files[0];
		const img = $(e.target).siblings('img')[0];

		img.dataset.src ??= img.src;

		if (f && f.type.startsWith('image/')) {
			img.onload = e => URL.revokeObjectURL(img.src);
			img.src = URL.createObjectURL(f);
		}
		else {
			img.src = img.dataset.src;
			e.target.value = '';
		}

		// Trigger input validation
		$(e.target).valid();
	});
	});
</script>
<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
@if (TempData["SuccessMessage"] != null)
{
	<script>
		Swal.fire({
			icon: 'success',
			title: 'Success',
			text: '@TempData["SuccessMessage"]'
		});
	</script>

}
@if (TempData["infoMessage"] != null)
{
	<script>
		Swal.fire({
			icon: 'info',
			title: 'No Change',
			text: '@TempData["infoMessage"]'
		});
	</script>
}

<script>
		$(document).ready(function() {
		$('.nav-link[data-ajax="true"]').on('click', function(e) {
			e.preventDefault();
			var url = $(this).data('url');

			if (url) {
				window.location.replace(url);  // Redirect to the desired URL without a full page reload
			}
		});
	});
</script>