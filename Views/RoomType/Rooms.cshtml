@* @model IEnumerable<RoomType> *@
    @model IEnumerable<HotelRoomReservationSystem.Models.ViewModels.RTWithImgVM>

<!-- Page Preloder -->

<div id="preloder">
    <div class="loader"></div>
</div>


    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=|Roboto+Sans:400,700|Playfair+Display:400,700">
    <link rel="stylesheet" href="/css/bootstrapss.min.css">
    <link rel="stylesheet" href="/css/animate.css" type="text/css">
    <link rel="stylesheet" href="/css/owl.carousels.min.css" type="text/css">
    <link rel="stylesheet" href="/css/aos.css" type="text/css">
    <link rel="stylesheet" href="/css/bootstrap-datepicker.css" type="text/css">
    <link rel="stylesheet" href="/css/jquery.timepicker.css" type="text/css">
    <link rel="stylesheet" href="/css/fancybox.min.css" type="text/css">
    <link rel="stylesheet" href="/fonts/ionicons/css/ionicons.min.css" type="text/css">
    <link rel="stylesheet" href="/fonts/fontawesome/css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="/fonts/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="/fonts/fontawesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/styless.css">
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/jquery-migrate-3.0.1.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousels.min.js"></script>
    <script src="/js/jquery.stellar.min.js"></script>
    <script src="/js/jquery.fancybox.min.js"></script>
    <script src="/js/aos.js"></script>
    <script src="/js/bootstrap-datepicker.js"></script>
    <script src="/js/jquery.timepicker.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="/js/mains.js"></script>

    <script>
//            $(document).on('click', '.category-card', function () {
//     var categoryId = $(this).data('categoryid'); // Get the categoryId from data attribute

//     // POST the categoryId to the server
//     $.ajax({
//         type: 'POST',
//         url: '/Category/CategoryDetails', // POST URL
//         data: { categoryId: categoryId },
//         success: function (response) {
//             if (response.redirectUrl) {
//                 // Redirect to the returned URL
//                 window.location.href = response.redirectUrl;
//             } else {
//                 alert('Error: Unable to redirect to category details.');
//             }
//         },
//         error: function (error) {
//             console.error('Error while processing the request:', error);
//         }
//     });
// });

                      $(document).on('click', '.roomType-card', function (e) {
            e.preventDefault();

                // Get the roomType ID
                        const roomTypeId = $(this).data('roomtypeid');
            // Perform AJAX POST request
            $.ajax({
                    url: '/RoomType/StoreRoomTypeId',
                type: 'POST',
                    data: { id: roomTypeId },
                success: function (response) {
                    // Redirect to the new page
                    if (response.redirectUrl) {
                        window.location.href = response.redirectUrl;
                    }
                },
                error: function (xhr, status, error) {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                }
            });
        });


        //      document.querySelectorAll('.room-card').forEach(function (element) {
        //     element.onclick = function (event) {
        //         Prevent any default behavior or text selection
        //         event.preventDefault();
        //         event.stopPropagation();

        //         Safely get the roomId attribute
        //         var roomId = this.getAttribute('data-roomid');
        //         if (roomId) {  Check if roomId exists
        //             console.log('Room ID:', roomId);
        //             $.ajax({
        //                 type: 'POST',
        //                 url: '/Home/RoomDetails',  Your POST endpoint
        //                 data: { roomId: roomId },  Pass the roomId to the controller
        //                 success: function (response) {
        //                     console.log('Room details received for roomId:', roomId);
        //                     window.location.href = '/Home/RoomDetails';  Optionally redirect after success
        //                 },
        //                 error: function (error) {
        //                     console.error('Error posting room details:', error);
        //                 }
        //             });
        //         } else {
        //             console.error('Room ID not found for this element');
        //         }
        //     };
        // });


           // const roomCards = document.querySelectorAll(".room-card");

           //  roomCards.forEach(card => {
           //      card.addEventListener("click", function () {
           //          const roomId = card.getAttribute("data-roomid");
           //          const redirectUrl = card.getAttribute("data-url");

           //          Send the Room ID to the server and redirect
           //          fetch(redirectUrl, {
           //              method: "POST",
           //              headers: { "Content-Type": "application/json" },
           //              body: JSON.stringify({ id: roomId })
           //          })
           //          .then(response => response.json())
           //          .then(data => {
           //              if (data.success) {
           //                  window.location.href = data.redirectUrl;
           //              } else {
           //                  alert("Error storing Room ID.");
           //              }
           //          })
           //          .catch(error => console.error("Error:", error));
           //      });
           //  });

                   $(document).ready(function () {
        // Debug form submission
        $("#checkAvailabilityForm").on("submit", function (e) {
            e.preventDefault();

            const checkInDate = $("#checkin_date").val();
            const checkOutDate = $("#checkout_date").val();

            console.log(`Form Submitted - CheckInDate: ${checkInDate}, CheckOutDate: ${checkOutDate}`);

            // Perform AJAX call
            $.ajax({
                url: $(this).attr("action"),
                type: "GET",
                data: {
                    checkInDate: checkInDate,
                    checkOutDate: checkOutDate
                },
                success: function (response) {
                    console.log("AJAX Success Response:", response);

                    // Check if partial HTML or JSON response
                    if (response.success === false) {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: response.message
                        });
                    } else {
                        // Update the room cards container with the response
                        $("#roomCardsContainer").html(response);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("AJAX Error:", error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: 'An unexpected error occurred.'
                    });
                }
            });
        });

        // Log user actions for debugging
        $("#checkin_date, #checkout_date").on("change", function () {
            console.log(`Date Input Changed - ID: ${this.id}, Value: ${this.value}`);
        });
    });
    </script>

    <style>
    #checkAvailabilityForm {
        width: 1000px;
    }
    </style>
<section class="site-hero inner-page overlay" style="background-image: url(/images/hero_4.jpg)" data-stellar-background-ratio="0.5">
    <div class="container">
        <div class="row site-hero-inner justify-content-center align-items-center">
            <div class="col-md-10 text-center" data-aos="fade">
                <h1 class="heading mb-3">Rooms</h1>
                <ul class="custom-breadcrumbs mb-4">
                    <li><a href="/Home/Index">Home</a></li>
                    <li>&bullet;</li>
                    <li>Rooms</li>
                </ul>
            </div>
        </div>
    </div>

    <a class="mouse smoothscroll" href="#next">
        <div class="mouse-icon">
            <span class="mouse-wheel"></span>
        </div>
    </a>
</section>
<!-- END section -->

<section class="section pb-4">
    <div class="container">

        <div class="row check-availabilty" id="next">
            <div class="block-32" data-aos="fade-up" data-aos-offset="-200">
                <form id="checkAvailabilityForm" method="get"
                      data-ajax="true"
                      data-ajax-update="#roomCardsContainer"
                      data-ajax-mode="replace"
                      class="p-3 bg-light shadow rounded">
                    <div class="row justify-content-between align-items-center">
                        <!-- Check-In -->
                        <div class="col-lg-4 d-flex align-items-center">
                            <label for="checkin_date" class="font-weight-bold text-black mb-0 mr-2" style="white-space: nowrap;">Check In</label>
                            <input type="date" name="checkInDate" id="checkin_date" class="form-control" required />
                        </div>
                        <!-- Check-Out -->
                        <div class="col-lg-4 d-flex align-items-center">
                            <label for="checkout_date" class="font-weight-bold text-black mb-0 mr-2" style="white-space: nowrap;">Check Out</label>
                            <input type="date" name="checkOutDate" id="checkout_date" class="form-control" required />
                        </div>
                        <!-- Check Availability Button -->
                        <div class="col-lg-3 d-flex justify-content-end">
                            <button type="submit" class="btn btn-warning text-white px-5">Check Availability</button>
                        </div>
                    </div>
                </form>
            </div>


        </div>
    </div>
</section>


@* <section class="section">
    <div class="container">

        <div class="row">
            @foreach (var c in Model)
            {
                <div class="col-md-6 col-lg-4 mb-5 roomType-card"
                     data-roomTypeId="@c.Id"
                     data-aos="fade-up">
                    <a href="javascript:void(0);" class="room">
                        <figure class="img-wrap">
                            <img src="/images/img_1.jpg" alt="Room Image" class="img-fluid mb-3">
                        </figure>
                        <div class="p-3 text-center category-info">
                            <h2>@c.Name</h2>
                            <span class="text-uppercase letter-spacing-1">RM @(c?.Price.ToString("F2") ?? "0.00") / per night</span>
                        </div>
                    </a>
                </div>
            }
        </div>
    </div>
</section> *@

<section class="section">
    <div class="container">
        <div id="roomCardsContainer">
            @await Html.PartialAsync("_RoomCardPartial", Model)
        </div>
    </div>
</section>

<section class="section bg-light">

    <div class="container">
        <div class="row justify-content-center text-center mb-5">
            <div class="col-md-7">
                <h2 class="heading" data-aos="fade">Great Offers</h2>
                <p data-aos="fade">Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.</p>
            </div>
        </div>

        <div class="site-block-half d-block d-lg-flex bg-white" data-aos="fade" data-aos-delay="100">
            <a href="#" class="image d-block bg-image-2" style="background-image: url('/images/img_1.jpg');"></a>
            <div class="text">
                <span class="d-block mb-4"><span class="display-4 text-primary">$199</span> <span class="text-uppercase letter-spacing-2">/ per night</span> </span>
                <h2 class="mb-4">Family Room</h2>
                <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.</p>
                <p><a href="#" class="btn btn-primary text-white">Book Now</a></p>
            </div>
        </div>
        <div class="site-block-half d-block d-lg-flex bg-white" data-aos="fade" data-aos-delay="200">
            <a href="#" class="image d-block bg-image-2 order-2" style="background-image: url('/images/img_2.jpg');"></a>
            <div class="text order-1">
                <span class="d-block mb-4"><span class="display-4 text-primary">$299</span> <span class="text-uppercase letter-spacing-2">/ per night</span> </span>
                <h2 class="mb-4">Presidential Room</h2>
                <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.</p>
                <p><a href="#" class="btn btn-primary text-white">Book Now</a></p>
            </div>
        </div>

    </div>
</section>

<section class="section bg-image overlay" style="background-image: url('/images/hero_4.jpg');">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 col-md-6 text-center mb-4 mb-md-0 text-md-left" data-aos="fade-up">
                <h2 class="text-white font-weight-bold">A Best Place To Stay. Reserve Now!</h2>
            </div>
            <div class="col-12 col-md-6 text-center text-md-right" data-aos="fade-up" data-aos-delay="200">
                <a href="reservation.html" class="btn btn-outline-white-primary py-3 text-white px-5">Reserve Now</a>
            </div>
        </div>
    </div>
</section>

